<div class="container">

    <h1>Documentation ApiRTC</h1>

    <h2>Usage et sémantique des classes</h2>

    <h3>UserAgent</h3>
    <p>Une instance de <code>UserAgent</code> représente un <strong>participant</strong>. C'est le point d'entrée à <strong>apiRTC</strong>.</p>

    <p>On instancie un <code>UserAgent</code> avec une clef d'API fournie par Apizee et associée à votre compte sur apizee.com : l'<code>apiKey</code>.</p>

    <p>La méthode <code>userAgent.register()</code> permet d'enregistrer un <strong>participant</strong> auprès des serveurs d'Apizee.</p>
    <p>L'enregistrement permet d'obtenir une instance de <code>Session</code> qui permettra d'utiliser les fonctionnalités connectées d'<strong>apiRTC</strong>.
    </p>

    <h3>Session</h3>
    <p>On obtient une instance de <code>Session</code> en retour (Promise) de la méthode
        <code>userAgent.register().then(session => ...)</code>.
    </p>
    <p>La session va permettre d'obtenir des objets permettant de mettre en oeuvre des fonctionnalités telles que les
        <strong>conversations</strong> ou <strong>conférences</strong>.
    </p>

    <h3>Conversation</h3>
    <p>On obtient une instance de <code>Conversation</code> en retour de la méthode
        <code>session.getOrCreateConversation(name)</code>.
    </p>

    <!-- note : ceci est bizarre  à explique pour joindre ume conversation c'est conversation.join() sémantiquement on aurait -->
    <!-- pu préférer que un User joigne la conversation -->
    <p>L'appel à la méthode <code>conversation.join()</code> permet au <strong>participant</strong> ayant créé cette instance de <code>Conversation</code> (via sa <code>Session</code>) de rejoindre la
        <strong>conversation</strong>.
    </p>

    <p>Une fois une <strong>conversation</strong> jointe, écouter sur l'event
        <code>conversation.on('streamListChanged', streamInfo => ...);</code> va permettre d'être informé sur l'arrivée de <strong>flux</strong> correspondant aux <strong>participants</strong> à la <strong>conversation</strong>.
    </p>

    <p>La méthode <code>conversation.subscribeToStream(streamInfo.streamId)</code> permet de souscrire à un flux.</p>
    <p>Une fois souscrit, écouter sur l'event <code>conversation.on('streamAdded', stream => ...);</code> permet d'obtenir une instance de <code>Stream</code>.</p>


    <h3>Conference</h3>
    <p>La conférence est une conversation avec la possibilité d'avoir un modérateur qui doit être un utilisateur géré par Apizee.</p>

    <h3>Stream</h3>
    <p>L'objet Stream porte des <strong>flux</strong> média d'un <strong>participant</strong>. Il permet de faire afficher dans le DOM la video et d'écouter le son du <strong>participant</strong>.</p>
    <p>TODO(vérifier) Un <strong>flux</strong> peut être vidéoe et audio, audio seul, ou video seul. Ce peut-etre un partage d'écran.</p>
    <p>Note plusieurs <strong>flux</strong> peuvent appartenir à un même <strong>participant</strong>.</p>
    <p>TODO : Du coup comment lier les stream entrant à un particpant ???</p>

    <h2>Code</h2>

    <pre><code>
userAgent = new UserAgent(&#123;uri: 'apzkey:' + yourApiKey&#125;)
userAgent.register().then(session => &#123;
    conversation = session.getOrCreateConversation('conversationName');
    //...
    &#125;;
</code></pre>
</div>